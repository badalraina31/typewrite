<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.5db83db345a8746542bf.css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.625;font-size:1rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:2.5rem;line-height:3.25rem;margin-top:6.5rem;margin-bottom:1.625rem}h2{font-size:1.6875rem;line-height:2.4375rem}h2,h3{margin-top:3.25rem;margin-bottom:.8125rem}h3{font-size:1.375rem;line-height:1.625rem}h4{font-size:1.2rem;margin-top:2.4375rem}h4,h5{line-height:1.625rem;margin-bottom:.8125rem}h5,h6{font-size:1rem;margin-top:4.0625rem}h6{line-height:1.625rem;margin-bottom:.8125rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#5d93ff;text-decoration:none}a:active,a:focus,a:hover{color:#f7a046}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.625rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.625rem;margin-bottom:1.625rem}blockquote{padding:0;font-style:italic;text-align:center}figure{display:block;width:100%;height:auto}figcaption{line-height:1.21875rem;margin-top:.40625rem;color:#222;font-size:.875rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.625rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.Author-module--author__photo--HnDWV{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--ZztQd{font-size:1.125rem;font-weight:600;line-height:1.82813rem;margin:.8125rem 0}.Author-module--author__title-link--BY7f8,.Author-module--author__title-link--BY7f8:focus,.Author-module--author__title-link--BY7f8:hover{color:#222}.Author-module--author__subtitle--3hbMX{color:#888;line-height:1.625rem;margin-bottom:1.625rem}.Icon-module--icon--1T2h2{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--3fb7G{margin-bottom:1.625rem}.Contacts-module--contacts__list--27zok{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--1Adud{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2L60c{border:0;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2L60c:focus,.Contacts-module--contacts__list-item-link--2L60c:hover{color:#5d93ff}.Copyright-module--copyright--1YLES{color:#b6b6b6;font-size:.875rem}.Menu-module--menu--2aN3O{margin-bottom:1.625rem}.Menu-module--menu__list--1uKDu{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--27cxj{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--29Sd-{font-size:1rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--29Sd-:focus,.Menu-module--menu__list-item-link--29Sd-:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Menu-module--menu__list-item-link--active--2HzKy{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--1zM7S{width:100%}.Sidebar-module--sidebar__inner--2Tprz{position:relative;padding:1.5625rem 1.25rem 0}@media screen and (min-width:685px){.Sidebar-module--sidebar--1zM7S{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--1zM7S:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--1zM7S:last-child{margin-right:0}.Sidebar-module--sidebar--1zM7S:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--1zM7S:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--2Tprz{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--2Tprz:after{background:#e6e6e6;background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--1zM7S{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--1zM7S:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--1zM7S:last-child{margin-right:0}.Sidebar-module--sidebar--1zM7S:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--1zM7S:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--2Tprz{padding:2.5rem}}.Layout-module--layout--EpQHE{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--EpQHE:before{content:"";display:table}.Layout-module--layout--EpQHE:after{content:"";display:table;clear:both}.Feed-module--feed__item--Bm0MP{margin-bottom:2.03125rem}.Feed-module--feed__item--Bm0MP:last-child{margin-bottom:.8125rem}.Feed-module--feed__item-title--34sOw{font-size:1.6875rem;line-height:2.4375rem;margin-top:0;margin-bottom:.8125rem}.Feed-module--feed__item-title-link--2qfTF{color:#222}.Feed-module--feed__item-title-link--2qfTF:focus,.Feed-module--feed__item-title-link--2qfTF:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--2_Zuy{font-size:1rem;line-height:1.625rem;margin-bottom:1.21875rem}.Feed-module--feed__item-meta-time--3hc6b{font-size:.875rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--2GeAw{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--lAu1I{font-size:.875rem;color:#f7a046;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--lAu1I:focus,.Feed-module--feed__item-meta-category-link--lAu1I:hover{color:#5d93ff}.Feed-module--feed__item-readmore--rMfbv{font-size:1rem;color:#5d93ff}.Feed-module--feed__item-readmore--rMfbv:focus,.Feed-module--feed__item-readmore--rMfbv:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Page-module--page--V2155{margin-bottom:3.25rem}.Page-module--page__inner--3xzwp{padding:1.5625rem 1.25rem}.Page-module--page__title--t1zKX{font-size:2.5rem;font-weight:600;line-height:3.25rem;margin-top:0;margin-bottom:2.35625rem}.Page-module--page__body--1A7TB{font-size:1rem;line-height:1.625rem;margin:0 0 1.625rem}@media screen and (min-width:685px){.Page-module--page--V2155{width:calc(58.275% - .78125rem)}.Page-module--page--V2155:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--V2155:last-child{margin-right:0}.Page-module--page--V2155:nth-child(12n){margin-right:0;float:right}.Page-module--page--V2155:nth-child(12n+1){clear:both}.Page-module--page__inner--3xzwp{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--V2155{width:calc(66.6% - .625rem)}.Page-module--page--V2155:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--V2155:last-child{margin-right:0}.Page-module--page--V2155:nth-child(3n){margin-right:0;float:right}.Page-module--page--V2155:nth-child(3n+1){clear:both}.Page-module--page__inner--3xzwp{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--3T_m0{margin-top:3.25rem;display:flex}.Pagination-module--pagination__prev--3tRFv{width:50%;text-align:left}.Pagination-module--pagination__prev-link--2vesn{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--2vesn:focus,.Pagination-module--pagination__prev-link--2vesn:hover{color:#5d93ff}.Pagination-module--pagination__prev-link--disable--1Fxw2{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--19bJd{width:50%;text-align:right}.Pagination-module--pagination__next-link--3ln7y{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3ln7y:focus,.Pagination-module--pagination__next-link--3ln7y:hover{color:#5d93ff}.Pagination-module--pagination__next-link--disable--AsM50{pointer-events:none;color:#bbb}.Author-module--author--2kf8a{border-top:1px solid #e6e6e6;max-width:40rem;padding-top:1.25rem;line-height:1.625rem;margin-top:1.625rem;margin-bottom:3.25rem}.Author-module--author__bio-twitter--MufFK{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2kf8a{margin-left:auto;margin-right:auto}}.Content-module--content--1tfQQ{max-width:59.0625rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--1qFLI{font-size:2rem;max-width:40rem;font-weight:600;text-align:center;line-height:2.68125rem;margin:1.625rem auto 0}.Content-module--content__body--2bfha figure{margin-bottom:1.625rem}.Content-module--content__body--2bfha figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.Content-module--content__body--2bfha figure blockquote p{max-width:40rem;font-size:1.6817rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.Content-module--content__body--2bfha a{text-decoration:underline}.Content-module--content__body--2bfha *{max-width:40rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2bfha img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--1tfQQ{padding:0}.Content-module--content__title--1qFLI{font-size:3rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.Content-module--content__body--2bfha,.Content-module--content__body--2bfha p{font-size:1.125rem;line-height:1.82813rem;margin-bottom:1.82813rem}}.Meta-module--meta__date--3FNDv{font-style:italic}.Tags-module--tags--1oNz4{margin-bottom:.8125rem}.Tags-module--tags__list--2UTD-{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--b7tap{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--1hQL0{display:inline-block;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--1hQL0:focus,.Tags-module--tags__list-item-link--1hQL0:hover{color:#5d93ff}.Post-module--post__comments--2T8dL,.Post-module--post__footer--1BvmJ{max-width:40rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--3zx_9{display:block;max-width:5.625rem;height:2.1875rem;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:1rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.625rem}.Post-module--post__home-button--3zx_9:focus,.Post-module--post__home-button--3zx_9:hover{color:#5d93ff}@media screen and (min-width:960px){.Post-module--post__comments--2T8dL,.Post-module--post__footer--1BvmJ{padding:0}.Post-module--post__home-button--3zx_9{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.20.23"/><link rel="alternate" type="application/rss+xml" title="Typewrite" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KFC593E1M8"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-KFC593E1M8', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/icons/icon-48x48.png?v=9d41517fa5ca2c67d0a2d2213cfecf88"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=9d41517fa5ca2c67d0a2d2213cfecf88"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=9d41517fa5ca2c67d0a2d2213cfecf88"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=9d41517fa5ca2c67d0a2d2213cfecf88"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=9d41517fa5ca2c67d0a2d2213cfecf88"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=9d41517fa5ca2c67d0a2d2213cfecf88"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=9d41517fa5ca2c67d0a2d2213cfecf88"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=9d41517fa5ca2c67d0a2d2213cfecf88"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=9d41517fa5ca2c67d0a2d2213cfecf88"/><title data-react-helmet="true">How are Function Components are Different from Classes - Typewrite</title><meta data-react-helmet="true" name="description" content="The&#x27;re a whole different Pokemon."/><meta data-react-helmet="true" property="og:site_name" content="How are Function Components are Different from Classes - Typewrite"/><meta data-react-helmet="true" property="og:image" content="https://badalraina31.github.io/typewrite//media/image-2.jpg"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="How are Function Components are Different from Classes - Typewrite"/><meta data-react-helmet="true" name="twitter:description" content="The&#x27;re a whole different Pokemon."/><meta data-react-helmet="true" name="twitter:image" content="https://badalraina31.github.io/typewrite//media/image-2.jpg"/><link as="script" rel="preload" href="/webpack-runtime-ae58b1f5c8ad780e1e3c.js"/><link as="script" rel="preload" href="/framework-7656862d80676d58607a.js"/><link as="script" rel="preload" href="/532a2f07-05d0124221769214927b.js"/><link as="script" rel="preload" href="/app-f965f1e2fd8e90ba6e68.js"/><link as="script" rel="preload" href="/styles-0dd9b16d06f2e4f550cc.js"/><link as="script" rel="preload" href="/cd95ea5cbd2c605f26db819f07999610c9ff4310-975e944040fc090517ed.js"/><link as="script" rel="preload" href="/643651a62fb35a9bb4f20061cb1f214a352d7976-e1c811e67e06b8931249.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-dc1a67bee8eb8a94aac2.js"/><link as="fetch" rel="preload" href="/page-data\posts\how-are-function-components-defferent-from-classes\how-are-function-components-different-from-classes\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data\app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--EpQHE"><div><a class="Post-module--post__home-button--3zx_9" href="/">All Articles</a><div><div class="Content-module--content--1tfQQ"><h1 class="Content-module--content__title--1qFLI">How are Function Components are Different from Classes</h1><div class="Content-module--content__body--2bfha"><p>How do React function components differ from React classes?</p>
<p>For a while, the canonical answer has been that classes provide access to more features (like state). With <a href="https://reactjs.org/docs/hooks-intro.html" target="_blank" rel="nofollow noopener noreferrer">Hooks</a>, that’s not true anymore.</p>
<p>Maybe you’ve heard one of them is better for performance. Which one? Many of such benchmarks are <a href="https://medium.com/@dan_abramov/this-benchmark-is-indeed-flawed-c3d6b5b6f97f?source=your_stories_page---------------------------" target="_blank" rel="nofollow noopener noreferrer">flawed</a> so I’d be careful <a href="https://github.com/ryardley/hooks-perf-issues/pull/2" target="_blank" rel="nofollow noopener noreferrer">drawing conclusions</a> from them. Performance primarily depends on what the code is doing rather than whether you chose a function or a class. In our observation, the performance differences are negligible, though optimization strategies are a bit <a href="https://reactjs.org/docs/hooks-faq.html#are-hooks-slow-because-of-creating-functions-in-render" target="_blank" rel="nofollow noopener noreferrer">different</a>.</p>
<p>In either case we <a href="https://reactjs.org/docs/hooks-faq.html#should-i-use-hooks-classes-or-a-mix-of-both" target="_blank" rel="nofollow noopener noreferrer">don’t recommend</a> rewriting your existing components unless you have other reasons and don’t mind being an early adopter. Hooks are still new (like React was in 2014), and some “best practices” haven’t yet found their way into the tutorials.</p>
<p>So where does that leave us? Are there any fundamental differences between React functions and classes at all? Of course, there are — in the mental model. <strong>In this post, I will look at the biggest difference between them.</strong> It existed ever since function components were <a href="https://reactjs.org/blog/2015/09/10/react-v0.14-rc1.html#stateless-function-components" target="_blank" rel="nofollow noopener noreferrer">introduced</a> in 2015 but it’s often overlooked:</p>
<blockquote>
<p><strong>Function components capture the rendered values.</strong></p>
</blockquote>
<p>Let’s unpack what this means.</p>
<hr>
<p><strong>Note: this post isn’t a value judgement of either classes or functions. I’m only describing the difference between these two programming models in React. For questions about adopting functions more widely, refer to the <a href="https://reactjs.org/docs/hooks-faq.html#adoption-strategy" target="_blank" rel="nofollow noopener noreferrer">Hooks FAQ</a>.</strong></p>
<hr>
<p>Consider this component:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">ProfilePage</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Followed '</span> <span class="token operator">+</span> props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Follow</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>It shows a button that simulates a network request with <code class="language-text">setTimeout</code> and then shows a confirmation alert. For example, if <code class="language-text">props.user</code> is <code class="language-text">&#39;Dan&#39;</code>, it will show <code class="language-text">&#39;Followed Dan&#39;</code> after three seconds. Simple enough.</p>
<p><em>(Note it doesn’t matter whether I use arrows or function declarations in the above example. <code class="language-text">function handleClick()</code> would work exactly the same way.)</em></p>
<p>How do we write it as a class? A naïve translation might look like this:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ProfilePage</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Followed '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Follow</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>It is common to think these two snippets of code are equivalent. People often freely refactor between these patterns without noticing their implications:</p>
<p><img src="/1d3c7a341ee3fcadc79df00e7d872e4b/wtf.gif" alt="Spot the difference between two versions"></p>
<p><strong>However, these two snippets of code are subtly different.</strong> Take a good look at them. Do you see the difference yet? Personally, it took me a while to see this.</p>
<p><strong>There are spoilers ahead so here’s a <a href="https://codesandbox.io/s/pjqnl16lm7" target="_blank" rel="nofollow noopener noreferrer">live demo</a> if you wanna figure it out on your own.</strong> The rest of this article explains the difference and why it matters.</p>
<hr>
<p>Before we continue, I’d like to emphasize that the difference I’m describing has nothing to do with React Hooks per se. Examples above don’t even use Hooks!</p>
<p>It’s all about the difference between functions and classes in React. If you plan to use functions more often in a React app, you might want to understand it.</p>
<hr>
<p><strong>We’ll illustrate the difference with a bug that is common in React applications.</strong></p>
<p>Open this <strong><a href="https://codesandbox.io/s/pjqnl16lm7" target="_blank" rel="nofollow noopener noreferrer">example sandbox</a></strong> with a current profile selector and the two <code class="language-text">ProfilePage</code> implementations from above — each rendering a Follow button.</p>
<p>Try this sequence of actions with both buttons:</p>
<ol>
<li><strong>Click</strong> one of the Follow buttons.</li>
<li><strong>Change</strong> the selected profile before 3 seconds pass.</li>
<li><strong>Read</strong> the alert text.</li>
</ol>
<p>You will notice a peculiar difference:</p>
<ul>
<li>With the above <code class="language-text">ProfilePage</code> <strong>function</strong>, clicking Follow on Dan’s profile and then navigating to Sophie’s would still alert <code class="language-text">&#39;Followed Dan&#39;</code>.</li>
<li>With the above <code class="language-text">ProfilePage</code> <strong>class</strong>, it would alert <code class="language-text">&#39;Followed Sophie&#39;</code>:</li>
</ul>
<p><img src="/386a449110202d5140d67336a0ade5a0/bug.gif" alt="Demonstration of the steps"></p>
<hr>
<p>In this example, the first behavior is the correct one. <strong>If I follow a person and then navigate to another person’s profile, my component shouldn’t get confused about who I followed.</strong> This class implementation is clearly buggy. </p>
<p><em>(You should totally <a href="https://mobile.twitter.com/sophiebits" target="_blank" rel="nofollow noopener noreferrer">follow Sophie</a> though.)</em></p>
<hr>
<p>So why does our class example behave this way?</p>
<p>Let’s look closely at the <code class="language-text">showMessage</code> method in our class:</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ProfilePage</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Followed '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>This class method reads from <code class="language-text">this.props.user</code>. Props are immutable in React so they can never change. <strong>However, <code class="language-text">this</code> <em>is</em>, and has always been, mutable.</strong></p>
<p>Indeed, that’s the whole purpose of <code class="language-text">this</code> in a class. React itself mutates it over time so that you can read the fresh version in the <code class="language-text">render</code> and lifecycle methods.</p>
<p>So if our component re-renders while the request is in flight, <code class="language-text">this.props</code> will change. The <code class="language-text">showMessage</code> method reads the <code class="language-text">user</code> from the “too new” <code class="language-text">props</code>.</p>
<p>This exposes an interesting observation about the nature of user interfaces. If we say that a UI is conceptually a function of current application state, <strong>the event handlers are a part of the render result — just like the visual output</strong>. Our event handlers “belong” to a particular render with particular props and state.</p>
<p>However, scheduling a timeout whose callback reads <code class="language-text">this.props</code> breaks that association. Our <code class="language-text">showMessage</code> callback is not “tied” to any particular render, and so it “loses” the correct props. Reading from <code class="language-text">this</code> severed that connection.</p>
<hr>
<p><strong>Let’s say function components didn’t exist.</strong> How would we solve this problem?</p>
<p>We’d want to somehow “repair” the connection between the <code class="language-text">render</code> with the correct props and the <code class="language-text">showMessage</code> callback that reads them. Somewhere along the way the <code class="language-text">props</code> get lost.</p>
<p>One way to do it would be to read <code class="language-text">this.props</code> early during the event, and then explicitly pass them through into the timeout completion handler:</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ProfilePage</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Followed '</span> <span class="token operator">+</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> <span class="token punctuation">{</span>user<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span></span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showMessage</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Follow</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>This <a href="https://codesandbox.io/s/3q737pw8lq" target="_blank" rel="nofollow noopener noreferrer">works</a>. However, this approach makes the code significantly more verbose and error-prone with time. What if we needed more than a single prop? What if we also needed to access the state? <strong>If <code class="language-text">showMessage</code> calls another method, and that method reads <code class="language-text">this.props.something</code> or <code class="language-text">this.state.something</code>, we’ll have the exact same problem again.</strong> So we would have to pass <code class="language-text">this.props</code> and <code class="language-text">this.state</code> as arguments through every method called from <code class="language-text">showMessage</code>.</p>
<p>Doing so defeats the ergonomics normally afforded by a class. It is also difficult to remember or enforce, which is why people often settle for bugs instead.</p>
<p>Similarly, inlining the <code class="language-text">alert</code> code inside <code class="language-text">handleClick</code> doesn’t answer the bigger problem. We want to structure the code in a way that allows splitting it into more methods <em>but</em> also reading the props and state that correspond to the render related to that call. <strong>This problem isn’t even unique to React — you can reproduce it in any UI library that puts data into a mutable object like <code class="language-text">this</code>.</strong></p>
<p>Perhaps, we could <em>bind</em> the methods in the constructor?</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ProfilePage</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>showMessage <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showMessage</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span>

  <span class="token function">showMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Followed '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Follow</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>No, this doesn’t fix anything. Remember, the problem is us reading from <code class="language-text">this.props</code> too late — not with the syntax we’re using! <strong>However, the problem would go away if we fully relied on JavaScript closures.</strong></p>
<p>Closures are often avoided because it’s <a href="https://wsvincent.com/javascript-closure-settimeout-for-loop/" target="_blank" rel="nofollow noopener noreferrer">hard</a> to think about a value that can be mutated over time. But in React, props and state are immutable! (Or at least, it’s a strong recommendation.) That removes a major footgun of closures.</p>
<p>This means that if you close over props or state from a particular render, you can always count on them staying exactly the same:</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ProfilePage</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token comment">// Capture the props!</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span></span>
    <span class="token comment">// Note: we are *inside render*.</span>
    <span class="token comment">// These aren't class methods.</span>
    <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Followed '</span> <span class="token operator">+</span> props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Follow</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>You’ve “captured” props at the time of render:</strong></p>
<p><img src="/fa483dd5699aac1350c57591770a49be/pokemon.gif" alt="Capturing Pokemon"></p>
<p>This way any code inside it (including <code class="language-text">showMessage</code>) is guaranteed to see the props for this particular render. React doesn’t “move our cheese” anymore.</p>
<p><strong>We could then add as many helper functions inside as we want, and they would all use the captured props and state.</strong> Closures to the rescue!</p>
<hr>
<p>The <a href="https://codesandbox.io/s/oqxy9m7om5" target="_blank" rel="nofollow noopener noreferrer">example above</a> is correct but it looks odd. What’s the point of having a class if you define functions inside <code class="language-text">render</code> instead of using class methods?</p>
<p>Indeed, we can simplify the code by removing the class “shell” around it:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">ProfilePage</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Followed '</span> <span class="token operator">+</span> props<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Follow</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Just like above, the <code class="language-text">props</code> are still being captured — React passes them as an argument. <strong>Unlike <code class="language-text">this</code>, the <code class="language-text">props</code> object itself is never mutated by React.</strong></p>
<p>It’s a bit more obvious if you destructure <code class="language-text">props</code> in the function definition:</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="gatsby-highlight-code-line"><span class="token keyword">function</span> <span class="token function">ProfilePage</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> user <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Followed '</span> <span class="token operator">+</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Follow</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>When the parent component renders <code class="language-text">ProfilePage</code> with different props, React will call the <code class="language-text">ProfilePage</code> function again. But the event handler we already clicked “belonged” to the previous render with its own <code class="language-text">user</code> value and the <code class="language-text">showMessage</code> callback that reads it. They’re all left intact.</p>
<p>This is why, in the function version of <a href="https://codesandbox.io/s/pjqnl16lm7" target="_blank" rel="nofollow noopener noreferrer">this demo</a>, clicking Follow on Sophie’s profile and then changing selection to Sunil would alert <code class="language-text">&#39;Followed Sophie&#39;</code>:</p>
<p><img src="/84396c4b3982827bead96912a947904e/fix.gif" alt="Demo of correct behavior"></p>
<p>This behavior is correct. <em>(Although you might want to <a href="https://mobile.twitter.com/threepointone" target="_blank" rel="nofollow noopener noreferrer">follow Sunil</a> too!)</em></p>
<hr>
<p>Now we understand the big difference between functions and classes in React:</p>
<blockquote>
<p><strong>Function components capture the rendered values.</strong></p>
</blockquote>
<p><strong>With Hooks, the same principle applies to state as well.</strong> Consider this example:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">MessageThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'You said: '</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleSendClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleMessageChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setMessage</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleMessageChange<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSendClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Send</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>(Here’s a <a href="https://codesandbox.io/s/93m5mz9w24" target="_blank" rel="nofollow noopener noreferrer">live demo</a>.)</p>
<p>While this isn’t a very good message app UI, it illustrates the same point: if I send a particular message, the component shouldn’t get confused about which message actually got sent. This function component’s <code class="language-text">message</code> captures the state that “belongs” to the render which returned the click handler called by the browser. So the <code class="language-text">message</code> is set to what was in the input when I clicked “Send”.</p>
<hr>
<p>So we know functions in React capture props and state by default. <strong>But what if we <em>want</em> to read the latest props or state that don’t belong to this particular render?</strong> What if we want to <a href="https://dev.to/scastiel/react-hooks-get-the-current-state-back-to-the-future-3op2" target="_blank" rel="nofollow noopener noreferrer">“read them from the future”</a>?</p>
<p>In classes, you’d do it by reading <code class="language-text">this.props</code> or <code class="language-text">this.state</code> because <code class="language-text">this</code> itself is mutable. React mutates it. In function components, you can also have a mutable value that is shared by all component renders. It’s called a “ref”:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// You can read or write `ref.current`.</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>However, you’ll have to manage it yourself.</p>
<p>A ref <a href="https://reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables" target="_blank" rel="nofollow noopener noreferrer">plays the same role</a> as an instance field. It’s the escape hatch into the mutable imperative world. You may be familiar with “DOM refs” but the concept is much more general. It’s just a box into which you can put something.</p>
<p>Even visually, <code class="language-text">this.something</code> looks like a mirror of <code class="language-text">something.current</code>. They represent the same concept.</p>
<p>By default, React doesn’t create refs for latest props or state in function components. In many cases you don’t need them, and it would be wasted work to assign them. However, you can track the value manually if you’d like:</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">MessageThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> latestMessage <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'You said: '</span> <span class="token operator">+</span> latestMessage<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleSendClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>showMessage<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">handleMessageChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setMessage</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">    latestMessage<span class="token punctuation">.</span>current <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>If we read <code class="language-text">message</code> in <code class="language-text">showMessage</code>, we’ll see the message at the time we pressed the Send button. But when we read <code class="language-text">latestMessage.current</code>, we get the latest value — even if we kept typing after the Send button was pressed.</p>
<p>You can compare the <a href="https://codesandbox.io/s/93m5mz9w24" target="_blank" rel="nofollow noopener noreferrer">two</a> <a href="https://codesandbox.io/s/ox200vw8k9" target="_blank" rel="nofollow noopener noreferrer">demos</a> to see the difference yourself. A ref is a way to “opt out” of the rendering consistency, and can be handy in some cases.</p>
<p>Generally, you should avoid reading or setting refs <em>during</em> rendering because they’re mutable. We want to keep the rendering predictable. <strong>However, if we want to get the latest value of a particular prop or state, it can be annoying to update the ref manually.</strong> We could automate it by using an effect:</p>
<div class="gatsby-highlight has-highlighted-lines" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">MessageThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>message<span class="token punctuation">,</span> setMessage<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token comment">// Keep track of the latest value.</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> latestMessage <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    latestMessage<span class="token punctuation">.</span>current <span class="token operator">=</span> message<span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
  <span class="token keyword">const</span> <span class="token function-variable function">showMessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'You said: '</span> <span class="token operator">+</span> latestMessage<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>(Here’s a <a href="https://codesandbox.io/s/yqmnz7xy8x" target="_blank" rel="nofollow noopener noreferrer">demo</a>.)</p>
<p>We do the assignment <em>inside</em> an effect so that the ref value only changes after the DOM has been updated. This ensures our mutation doesn’t break features like <a href="https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html" target="_blank" rel="nofollow noopener noreferrer">Time Slicing and Suspense</a> which rely on interruptible rendering.</p>
<p>Using a ref like this isn’t necessary very often. <strong>Capturing props or state is usually a better default.</strong> However, it can be handy when dealing with <a href="/making-setinterval-declarative-with-react-hooks/">imperative APIs</a> like intervals and subscriptions. Remember that you can track <em>any</em> value like this — a prop, a state variable, the whole props object, or even a function.</p>
<p>This pattern can also be handy for optimizations — such as when <code class="language-text">useCallback</code> identity changes too often. However, <a href="https://reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down" target="_blank" rel="nofollow noopener noreferrer">using a reducer</a> is often a <a href="https://github.com/ryardley/hooks-perf-issues/pull/3" target="_blank" rel="nofollow noopener noreferrer">better solution</a>. (A topic for a future blog post!)</p>
<hr>
<p>In this post, we’ve looked at common broken pattern in classes, and how closures help us fix it. However, you might have noticed that when you try to optimize Hooks by specifying a dependency array, you can run into bugs with stale closures. Does it mean that closures are the problem? I don’t think so.</p>
<p>As we’ve seen above, closures actually help us <em>fix</em> the subtle problems that are hard to notice. Similarly, they make it much easier to write code that works correctly in the <a href="https://reactjs.org/blog/2018/03/01/sneak-peek-beyond-react-16.html" target="_blank" rel="nofollow noopener noreferrer">Concurrent Mode</a>. This is possible because the logic inside the component closes over the correct props and state with which it was rendered.</p>
<p>In all cases I’ve seen so far, <strong>the “stale closures” problems happen due to a mistaken assumption that “functions don’t change” or that “props are always the same”</strong>. This is not the case, as I hope this post has helped to clarify.</p>
<p>Functions close over their props and state — and so their identity is just as important. This is not a bug, but a feature of function components. Functions shouldn’t be excluded from the “dependencies array” for <code class="language-text">useEffect</code> or <code class="language-text">useCallback</code>, for example. (The right fix is usually either <code class="language-text">useReducer</code> or the <code class="language-text">useRef</code> solution above — we will soon document how to choose between them.)</p>
<p>When we write the majority of our React code with functions, we need to adjust our intuition about <a href="https://github.com/ryardley/hooks-perf-issues/pull/3" target="_blank" rel="nofollow noopener noreferrer">optimizing code</a> and <a href="https://github.com/facebook/react/issues/14920" target="_blank" rel="nofollow noopener noreferrer">what values can change over time</a>.</p>
<p>As <a href="https://mobile.twitter.com/EphemeralCircle/status/1099095063223812096" target="_blank" rel="nofollow noopener noreferrer">Fredrik put it</a>:</p>
<blockquote>
<p>The best mental rule I’ve found so far with hooks is ”code as if any value can change at any time”.</p>
</blockquote>
<p>Functions are no exception to this rule. It will take some time for this to be common knowledge in React learning materials. It requires some adjustment from the class mindset. But I hope this article helps you see it with fresh eyes.</p>
<p>React functions always capture their values — and now we know why.</p>
<p><img src="/fc3bddf6d4ca14bc77917ac0cfad3608/pikachu.gif" alt="Smiling Pikachu"></p>
<p>They’re a whole different Pokémon.</p></div></div></div><div class="Post-module--post__footer--1BvmJ"><div><p class="Meta-module--meta__date--3FNDv">Published <!-- -->1 Apr 2020</p></div><div class="Tags-module--tags--1oNz4"><ul class="Tags-module--tags__list--2UTD-"><li class="Tags-module--tags__list-item--b7tap"><a class="Tags-module--tags__list-item-link--1hQL0" href="/tag/components/">Components</a></li><li class="Tags-module--tags__list-item--b7tap"><a class="Tags-module--tags__list-item-link--1hQL0" href="/tag/learning-to-write/">Learning to write</a></li></ul></div><div class="Author-module--author--2kf8a"><p><a class="Author-module--author__bio-twitter--MufFK" href="https://www.twitter.com/badalraina31" rel="noopener noreferrer" target="_blank"><strong>Badal Raina</strong> on Twitter</a></p></div></div><div class="Post-module--post__comments--2T8dL"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/how-are-function-components-defferent-from-classes/how-are-function-components-different-from-classes";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-f965f1e2fd8e90ba6e68.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-b3d32bc20641419cfed7.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-ea13db6a7bd1eed21c3d.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-d49b21ad1095227727ae.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-4fea02b2331b80583979.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-b396367855c15c54064a.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-6e7f88db81c1b10e86b4.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-dc1a67bee8eb8a94aac2.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-db6f5f313831914720ef.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-70c7a277c225fe5b2fed.js"]};/*]]>*/</script><script src="/component---src-templates-post-template-js-dc1a67bee8eb8a94aac2.js" async=""></script><script src="/643651a62fb35a9bb4f20061cb1f214a352d7976-e1c811e67e06b8931249.js" async=""></script><script src="/cd95ea5cbd2c605f26db819f07999610c9ff4310-975e944040fc090517ed.js" async=""></script><script src="/styles-0dd9b16d06f2e4f550cc.js" async=""></script><script src="/app-f965f1e2fd8e90ba6e68.js" async=""></script><script src="/532a2f07-05d0124221769214927b.js" async=""></script><script src="/framework-7656862d80676d58607a.js" async=""></script><script src="/webpack-runtime-ae58b1f5c8ad780e1e3c.js" async=""></script></body></html>